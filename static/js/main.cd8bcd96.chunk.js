(this["webpackJsonpwater-secure-map"]=this["webpackJsonpwater-secure-map"]||[]).push([[0],{40:function(t,e,a){t.exports=a.p+"static/media/left-arrow.2f02a21a.svg"},42:function(t,e,a){t.exports=a(63)},47:function(t,e,a){},55:function(t,e,a){},56:function(t,e,a){t.exports=a.p+"static/media/community.ecd7ea28.svg"},58:function(t,e,a){},59:function(t,e,a){},60:function(t,e,a){},61:function(t,e,a){},62:function(t,e,a){},63:function(t,e,a){"use strict";a.r(e);var n=a(0),o=a.n(n),c=a(23),r=a.n(c),i=(a(47),a(25)),l=a(26),s=a(29),u=a(28),m=a(27),d=a(16),p=a.n(d),f=a(3),v=a(10),h=a.n(v),E=a(12),b=a(14),g=a(15),y=a(7);function O(t){return t.toLowerCase().replace(new RegExp(" ","g"),"-")}a(53);var _=Object(g.b)({name:"location",initialState:{locations:[],categories:[],loading:!0,error:null,filters:{max_distance:0,contains_text:"",categories:[]},current_user_location:null,modalIsOpen:!1,brandLogo:null,brandAltText:null,activeLocation:null,features:{site_name_in_location:!0,show_distance:!1}},reducers:{fetchDataBegin:function(t){t.loading=!0,t.error=null},fetchDataSuccess:function(t,e){var a=e.payload.metadata.features||{};t.locations=e.payload.locations,t.categories=e.payload.categories,t.brandLogo=e.payload.metadata.brand_logo,t.brandAltText=e.payload.metadata.brand_alt,t.loading=!1,t.features.site_name_in_location=a.site_name_in_location||t.features.site_name_in_location,t.features.show_distance=a.show_distance||t.features.show_distance,document.title=e.payload.metadata.brand_alt,(function(t){for(var e=document.getElementsByTagName("meta"),a=0;a<e.length;a++)if(e[a].getAttribute("name")===t)return e[a];return""}("description")).content=e.payload.metadata.description},fetchDataFailure:function(t,e){t.error=e.payload.error},setMaxDistanceFilter:function(t,e){t.filters.max_distance=e.payload},setTextFilter:function(t,e){t.filters.contains_text=e.payload},setCategoryFilter:function(t,e){t.filters.categories=e.payload},setActiveLocation:function(t,e){e.payload?document.title=e.payload.title:document.title="WaterSecure",t.activeLocation=e.payload}}}),j=_.actions,L=j.fetchDataBegin,N=j.fetchDataSuccess,w=j.fetchDataFailure,T=(j.setMaxDistanceFilter,j.setTextFilter,j.setCategoryFilter,j.setActiveLocation);j.closeModal;var I=function(t){return t.location.locations},R=function(t){return t.location.categories},A=function(t){return t.location.activeLocation},S=Object(y.a)(I,(function(t){var e,a={},n=Object(m.a)(t);try{for(n.s();!(e=n.n()).done;){var o=e.value;console.log(o),a[O(o.title)]=o}}catch(c){n.e(c)}finally{n.f()}return a}));var k=function(t){return Object(n.useEffect)((function(){t.isRoot?t.setActiveLocation(null):t.location||t.setActiveLocation(t.urlLocation)})),o.a.createElement(o.a.Fragment,null)};k=Object(f.c)((function(t){var e=t.router.location.pathname.slice(1),a=S(t)[e];return{location:A(t),urlLocation:a,isRoot:""===e,siteName:t.location.brandAltText,site_name_in_location:t.location.features.site_name_in_location}}),{setActiveLocation:T})(k);var x=_.reducer,C=a(22),M=(a(55),a(9));a(56);p.a.accessToken="pk.eyJ1IjoieHJlbmRhbiIsImEiOiJjamlubXdoeDgwZDF5M3BvNzl1Nm51ZTF2In0.cRp5pTHYfVlg5Qfhh9npmg";var H=Object(C.a)((function(t,e){t.jumpTo({center:e})}),(function(t,e){return t.center===e.center})),D=Object(C.a)((function(t,e){t.jumpTo({zoom:e})}),(function(t,e){return t.zoom===e.zoom})),F=Object(C.a)((function(t,e){t.jumpTo({pitch:e})}),(function(t,e){return t.pitch===e.pitch})),U=function(t){Object(s.a)(a,t);var e=Object(u.a)(a);function a(){var t;Object(i.a)(this,a);for(var n=arguments.length,c=new Array(n),r=0;r<n;r++)c[r]=arguments[r];return(t=e.call.apply(e,[this].concat(c))).mapRef=o.a.createRef(),t.state={markers:[]},t.memoizedLoadLocations=Object(C.a)(t.loadLocations,(function(t,e){return t.locations===e.locations})),t}return Object(l.a)(a,[{key:"nextPath",value:function(t){this.props.history.push(t)}},{key:"loadLocations",value:function(t){var e=this;this.state.markers.forEach((function(t){t.remove()}));var a=[];t.forEach((function(t){console.log(t);var n=document.createElement("div");n.className="community",n.id="community-".concat(t.id),n.innerHTML='<svg height="512" viewBox="0 0 192 192" width="512" xmlns="http://www.w3.org/2000/svg"><path d="m96 0a72.081 72.081 0 0 0 -72 72c0 50.73 63.634 114.948 66.343 117.657a8.078 8.078 0 0 0 11.314 0c2.709-2.709 66.343-66.927 66.343-117.657a72.081 72.081 0 0 0 -72-72zm0 120a48 48 0 1 1 48-48 48 48 0 0 1 -48 48z"/><path d="m129.789 60.422-32-16a4 4 0 0 0 -3.578 0l-32 16 3.578 7.156 10.211-5.106v25.528a4 4 0 0 0 4 4h32a4 4 0 0 0 4-4v-25.528l10.211 5.106z"/></svg>',n.onclick=function(a){console.log(a),e.props.setActiveLocation(t),e.nextPath("/".concat(O(t.title)))};var o=new p.a.Popup({closeButton:!1,closeOnClick:!1,anchor:"bottom",offset:40});n.onmouseenter=function(a){o.setLngLat(t.coordinates).setHTML(t.title).addTo(e.map)},n.onmouseleave=function(t){o.remove()};var c=new p.a.Marker(n).setLngLat(t.coordinates).addTo(e.map);a.push(c),t.water_sources.forEach((function(n){var c=document.createElement("div");c.className="water-source water-source-".concat(t.id),c.innerHTML='<svg id="Capa_1" enable-background="new 0 0 512 512" height="512" viewBox="0 0 512 512" width="512" xmlns="http://www.w3.org/2000/svg"><path d="m332.667 225.548c-14.338 0-27.961-5.373-38.334-14.536-10.372 9.164-23.994 14.536-38.333 14.536-14.338 0-27.961-5.373-38.333-14.536-10.373 9.163-23.995 14.536-38.333 14.536-7.198 0-14.16-1.311-20.616-3.751 10.483 44 50.119 76.822 97.283 76.822s86.8-32.822 97.283-76.822c-6.457 2.44-13.419 3.751-20.617 3.751z"/><path d="m179.334 195.548c10.588 0 20.329-6.029 24.814-15.358 2.498-5.196 7.753-8.5 13.519-8.5s11.021 3.304 13.519 8.5c4.486 9.33 14.226 15.358 24.815 15.358s20.329-6.028 24.814-15.358c2.498-5.196 7.753-8.5 13.519-8.5 5.765 0 11.021 3.304 13.519 8.5 4.486 9.33 14.227 15.359 24.815 15.359 9.004 0 17.222-4.208 22.311-11.194-6.944-48.407-48.68-85.735-98.978-85.735s-92.034 37.329-98.978 85.736c5.089 6.985 13.307 11.192 22.311 11.192z"/><path d="m437.547 114.538c-15.946-33.427-40.411-61.704-70.748-81.776-32.393-21.433-70.708-32.762-110.799-32.762s-78.406 11.329-110.8 32.762c-30.336 20.071-54.8 48.349-70.747 81.776s-22.533 70.234-19.046 106.442c3.724 38.664 19.025 75.571 44.251 106.732l144.684 178.727c2.848 3.517 7.132 5.561 11.658 5.561s8.811-2.044 11.659-5.562l144.684-178.727c25.225-31.161 40.526-68.068 44.25-106.732 3.487-36.208-3.099-73.015-19.046-106.441zm-181.547 214.081c-71.682 0-130-58.318-130-130 0-4.237.211-8.425.609-12.558.004-.038.006-.076.01-.114 6.392-65.758 61.975-117.328 129.381-117.328 67.381 0 122.947 51.53 129.374 117.25.019.15.026.3.04.451.382 4.05.586 8.151.586 12.299 0 71.682-58.317 130-130 130z"/></svg>',c.onmouseenter=function(t){o.setLngLat(n.coordinates).setHTML(n.name).addTo(e.map)},c.onmouseleave=function(t){o.remove()};var r=new p.a.Marker(c).setLngLat(n.coordinates).addTo(e.map);a.push(r)})),e.setState({markers:a})}))}},{key:"componentDidUpdate",value:function(){this.memoizedLoadLocations(this.props.locations);try{H(this.map,this.props.center)}catch(t){throw console.log(t),t}try{D(this.map,this.props.zoom)}catch(t){}try{F(this.map,this.props.pitch)}catch(t){}}},{key:"componentDidMount",value:function(){var t=this;this.map=new p.a.Map({container:this.mapRef.current,style:"mapbox://styles/mapbox/streets-v9",customAttribution:"Icons by fjstudio & Freepik on Flaticon",center:this.props.center,zoom:this.props.zoom,pitch:this.props.pitch}),this.map.on("load",(function(){t.loadLocations(t.props.locations)}));var e=new p.a.Popup({closeButton:!1,closeOnClick:!1,anchor:"bottom",offset:40});this.map.on("mouseenter","locations",(function(a){t.props.onHover(a),t.map.getCanvas().style.cursor="pointer";for(var n=a.features[0].geometry.coordinates.slice(),o=a.features[0].properties.title;Math.abs(a.lngLat.lng-n[0])>180;)n[0]+=a.lngLat.lng>n[0]?360:-360;e.setLngLat(n).setHTML(o).addTo(t.map)})),this.map.on("click","locations",(function(e){t.props.onClick(e)})),this.map.on("mouseleave","locations",(function(a){t.map.getCanvas().style.cursor="",e.remove(),t.props.onMouseLeave(a)}))}},{key:"render",value:function(){return o.a.createElement("div",{ref:this.mapRef,style:{height:"100%"}})}}]),a}(o.a.Component);function z(t,e){var a=function(t,e){var a=!1;"#"===t[0]&&(t=t.slice(1),a=!0);var n=parseInt(t,16),o=(n>>16)+e;o>255?o=255:o<0&&(o=0);var c=(n>>8&255)+e;c>255?c=255:c<0&&(c=0);var r=(255&n)+e;return r>255?r=255:r<0&&(r=0),(a?"#":"")+(r|c<<8|o<<16).toString(16)}(e,175);return"#".concat(t," { background-color: ").concat(a,";}")}U=Object(f.c)((function(t){var e=R(t);return{center:t.metadata.initial_map_center,zoom:t.metadata.initial_map_zoom,pitch:t.metadata.initial_map_pitch,categories:R(t),locations:I(t),onHover:function(t){var a="location-".concat(t.features[0].properties.id),n=document.getElementById(a);null!==n&&n.scrollIntoView({behavior:"smooth"}),document.getElementById("hover-style").appendChild(document.createTextNode(z(a,e.find((function(e){return e.id===t.features[0].properties.category_id})).color)))},onMouseLeave:function(){document.getElementById("hover-style").textContent=""},onClick:function(t){var e=document.getElementById("location-".concat(t.features[0].properties.id));null!==e&&e.click()}}}),{setActiveLocation:T})(U);var B=Object(M.e)(U);a(58);var P=Object(g.b)({name:"metadata",initialState:{loading:!0,error:null,brandLogo:null,brandAltText:null,title:null,favicon:null,menuItems:[],description:null,initial_map_center:[-113.496548,53.511435],initial_map_zoom:[11.25],initial_map_pitch:[50]},reducers:{fetchDataBegin:function(t){t.loading=!0,t.error=null},fetchDataSuccess:function(t,e){t.loading=!1,t.error=null,t.brandLogo=e.payload.metadata.brand_logo,t.brandAltText=e.payload.metadata.brand_alt,t.title=e.payload.metadata.title,t.favicon=e.payload.metadata.favicon,t.menuItems=e.payload.metadata.menuItems,t.description=e.payload.metadata.description,document.title=e.payload.metadata.title,t.initial_map_center=e.payload.map_metadata.initial_map_center.coordinates,t.initial_map_zoom=[e.payload.map_metadata.initial_map_zoom],t.initial_map_pitch=[e.payload.map_metadata.initial_map_pitch],(function(t){for(var e=document.getElementsByTagName("meta"),a=0;a<e.length;a++)if(e[a].getAttribute("name")===t)return e[a];return""}("description")).content=e.payload.metadata.description},fetchDataFailure:function(t,e){t.error=e.payload.error}}}),W=function(t){return t.metadata.brandLogo},V=function(t){return t.metadata.brandAltText},Y=function(t){return t.metadata.menuItems||[]},G=P.actions,J=G.fetchDataBegin,K=G.fetchDataSuccess,Q=G.fetchDataFailure;function Z(){return function(){var t=Object(b.a)(h.a.mark((function t(e){var a,n;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e(J()),t.prev=1,t.next=4,fetch("./data/project.json").then((function(t){return t.json()}));case 4:a=t.sent,(n=a.metadata.map).initial_map_center={initial_map_center:{type:"Point",coordinates:n.initial_map_center}},e(K({metadata:a.metadata.app,map_metadata:n})),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(1),e(Q(t.t0));case 13:case"end":return t.stop()}}),t,null,[[1,10]])})));return function(e){return t.apply(this,arguments)}}()}var X=P.reducer;a(59);function $(t){return o.a.createElement("li",{className:"nav-item"},o.a.createElement("a",{href:t.link},t.title))}var q=function(){return window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth};var tt=Object(f.c)((function(t){return{logoUrl:W(t),altText:V(t),menuItems:Y(t)}}),{fetchMetaData:Z})((function(t){var e=function(){var t=Object(n.useState)(q()),e=Object(E.a)(t,2),a=e[0],o=e[1];return Object(n.useEffect)((function(){var t=null,e=function(){clearTimeout(t),t=setTimeout((function(){return o(q())}),150)};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[]),a}()<(t.collapsedWidth||992),a=t.menuItems.map((function(t){return o.a.createElement($,Object.assign({key:t.title},t))}));return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"vertical-center nav-title"},o.a.createElement("img",{src:t.logoUrl,alt:t.altText})),o.a.createElement("ul",{className:"nav-items"},e?o.a.createElement("li",{className:"vertical-center"},o.a.createElement("a",{href:"#","aria-haspopup":"true"},"Menu"),o.a.createElement("ul",{className:"dropdown","aria-label":"sublabel"},a)):a.slice(0).reverse()))})),et=(a(60),function(t){Object(s.a)(a,t);var e=Object(u.a)(a);function a(){return Object(i.a)(this,a),e.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return this.props.spinning?o.a.createElement("div",{className:"overlay"},o.a.createElement("div",{className:"spinner"})):null}}]),a}(o.a.Component));Object(f.c)((function(t){return{spinning:t.location.loading}}))(et);var at=a(39);a(61);var nt=function(){var t=Object(n.useState)(""),e=Object(E.a)(t,2),a=e[0],c=e[1];return Object(n.useEffect)((function(){function t(){return(t=Object(b.a)(h.a.mark((function t(){var e;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("./data/welcome.md").then((function(t){return t.text()}));case 2:e=t.sent,c(Object(at.a)(e));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[]),o.a.createElement("div",{className:"sidebar welcome",dangerouslySetInnerHTML:{__html:a}})},ot=(a(62),a(19)),ct=a(40),rt=a.n(ct),it={0:"UNAVAILABLE INFORMATION",1:"VERY LOW RISK",2:"LOW RISK",3:"MODERATE RISK",4:"HIGH RISK",5:"VERY HIGH RISK"},lt={"Sources and Availability":{0:"UNAVAILABLE INFORMATION",1:"VERY HIGH ACCESS",2:"HIGH ACCESS",3:"MODERATE ACCESS",4:"LOW ACCESS",5:"VERY LOW ACCESS"},"Consumption and Usage":{0:"UNAVAILABLE INFORMATION",1:"VERY LOW CONSUMPTION",2:"LOW CONSUMPTION",3:"MODERATE CONSUMPTION",4:"HIGH CONSUMPTION",5:"VERY HIGH CONSUMPTION"},"Infrastructure and Distribution":{0:"UNAVAILABLE INFORMATION",1:"VERY STRONG INFRASTRUCTURE",2:"STRONG INFRASTRUCTURE",3:"ADEQUATE INFRASTRUCTURE",4:"POOR INFRASTRUCTURE",5:"VERY POOR INFRASTRUCTURE"},"Human Health":it,"Animal Health":it,"Waterbody Health":it,"Human Pollution":it};function st(t){for(var e=[],a=0,n=Object.entries(t.factors);a<n.length;a++){var c=Object(E.a)(n[a],2),r=c[0],i=c[1];e.push(o.a.createElement(dt,{key:r,title:r,metrics:i}))}return o.a.createElement("div",{className:"tab"},o.a.createElement("p",null,t.current_analysis),e,o.a.createElement("p",null,t.future_analysis))}function ut(){return o.a.createElement("div",{className:"documents"},"Hello")}function mt(t){return o.a.createElement("div",{className:"metric"},o.a.createElement("div",{className:"indicator level-".concat(t.level)}),o.a.createElement("div",{className:"metric-text"},o.a.createElement("div",{className:"metric-title"},t.title),o.a.createElement("div",{className:"metric-value"},lt[t.section][t.level])))}function dt(t){for(var e=[],a=0,n=Object.entries(t.metrics);a<n.length;a++){var c=Object(E.a)(n[a],2),r=c[0],i=c[1];e.push(o.a.createElement(mt,{section:t.title,key:r,title:r,level:i}))}return o.a.createElement("div",{className:"metric-section"},o.a.createElement("h2",null,t.title),e)}var pt=Object(f.c)((function(t){return{location:A(t)}}))((function(t){var e=Object(n.useState)("Water Security"),a=Object(E.a)(e,2),c=a[0],r=a[1];if(console.log(c),!t.location)return o.a.createElement("div",{className:"sidebar location-sidebar"});var i=t.location.tabs;return o.a.createElement("div",{className:"sidebar location-sidebar"},o.a.createElement("div",{className:"content"},o.a.createElement("div",{className:"header"},o.a.createElement("h1",null,o.a.createElement(ot.a,{to:"/"},o.a.createElement("img",{className:"backarrow",src:rt.a,alt:"back"})),t.location.title),o.a.createElement("p",null,"Population of"," ",t.location.population.toLocaleString("en-US",{minimumFractionDigits:0}))),o.a.createElement("br",null),o.a.createElement("p",null,t.location.description),o.a.createElement("button",{onClick:function(){return r("Water Security")}},"Water Security"),o.a.createElement("button",{onClick:function(){return r("Population Health")}},"Population Health"),o.a.createElement("button",{onClick:function(){return r("Environmental Risks")}},"Environmental Risks"),"Water Security"===c?o.a.createElement(st,i["Water Security"]):null,"Population Health"===c?o.a.createElement(st,i["Population Health"]):null,"Environmental Risks"===c?o.a.createElement(st,i["Environmental Risks"]):null),o.a.createElement(ut,null))}));var ft=Object(f.c)((function(t){return{location:A(t),spinning:t.location.loading,siteName:t.location.brandAltText,currentPath:t.router.location.pathname.slice(1)}}),{fetchMetaData:Z,fetchLocationData:function(){return function(){var t=Object(b.a)(h.a.mark((function t(e){var a,n,o,c,r;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e(L()),t.prev=1,t.next=4,Promise.all([fetch("./data/locations.json").then((function(t){return t.json()})),fetch("./data/project.json").then((function(t){return t.json()})),fetch("./data/categories.json").then((function(t){return t.json()}))]);case 4:a=t.sent,n=Object(E.a)(a,3),o=n[0],c=n[1],r=n[2],console.log(o),e(N({locations:o.locations,metadata:c.metadata,categories:r.categories})),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(1),e(w(t.t0));case 16:case"end":return t.stop()}}),t,null,[[1,13]])})));return function(e){return t.apply(this,arguments)}}()}})((function(t){var e=t.fetchMetaData,a=t.fetchLocationData;return Object(n.useEffect)((function(){""===t.currentPath&&(document.title=t.siteName)})),Object(n.useEffect)((function(){e()}),[e]),Object(n.useEffect)((function(){a()}),[a]),o.a.createElement(o.a.Fragment,null,o.a.createElement("nav",{role:"navigation",className:"navbar"},o.a.createElement(tt,null)),o.a.createElement(nt,null),o.a.createElement(pt,null),o.a.createElement("div",{className:"map"},o.a.createElement(B,null)),o.a.createElement(M.a,{path:"/:locationName",render:function(){return o.a.createElement("style",{dangerouslySetInnerHTML:{__html:"div.location-sidebar { width: 100%; }"}})}}),o.a.createElement(k,null))})),vt=a(41),ht=a(17),Et=a(6),bt=a(36),gt=Object(Et.a)({}),yt=Object(g.a)({reducer:{location:x,metadata:X,router:Object(ht.b)(gt)},middleware:[].concat(Object(vt.a)(Object(g.c)()),[Object(bt.a)(gt)])});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(f.a,{store:yt},o.a.createElement(ht.a,{history:gt}," ",o.a.createElement(ft,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))}},[[42,1,2]]]);
//# sourceMappingURL=main.cd8bcd96.chunk.js.map