{"version":3,"sources":["features/locations/left-arrow.svg","features/map/community.svg","utils.js","features/locations/locationSlice.js","features/map/Map.js","features/map/icons.js","features/Meta/metaSlice.js","features/Meta/NavBar.js","features/locations/Spinner.js","features/Meta/WelcomeSidebar.js","features/locations/LocationSidebar.js","App.js","app/store.js","serviceWorker.js","index.js"],"names":["module","exports","urlify_location","name","toLowerCase","replace","RegExp","locationSlice","createSlice","initialState","locations","categories","loading","error","filters","max_distance","contains_text","current_user_location","modalIsOpen","brandLogo","brandAltText","activeLocation","features","site_name_in_location","show_distance","reducers","fetchDataBegin","state","fetchDataSuccess","action","payload","metadata","brand_logo","brand_alt","document","title","metaName","metas","getElementsByTagName","i","length","getAttribute","getMeta","content","description","fetchDataFailure","setMaxDistanceFilter","setTextFilter","setCategoryFilter","setActiveLocation","actions","closeModal","allLocationsSelector","location","allCategoriesSelector","activeLocationSelector","urlToLocationMapSelector","createSelector","url_map","console","log","LocationOpener","props","useEffect","isRoot","urlLocation","connect","path","router","pathname","slice","siteName","mapboxgl","accessToken","memoizedCenterMap","memoizeOne","map","center","jumpTo","newArgs","lastArgs","memoizedZoomMap","zoom","memoizedPitchMap","pitch","Map","mapRef","React","createRef","markers","memoizedLoadLocations","loadLocations","this","history","push","forEach","marker","remove","el","createElement","className","id","innerHTML","onclick","e","nextPath","popup","Popup","closeButton","closeOnClick","anchor","offset","onmouseenter","setLngLat","coordinates","setHTML","addTo","onmouseleave","Marker","water_sources","water_source","setState","container","current","style","customAttribution","on","onHover","getCanvas","cursor","geometry","properties","Math","abs","lngLat","lng","onClick","onMouseLeave","ref","height","Component","getBackgroundCSS","elementID","pinColour","backgroundColor","colorCode","amount","usePound","num","parseInt","r","b","g","toString","utils","initial_map_center","initial_map_zoom","initial_map_pitch","locationHtmlId","elmnt","getElementById","scrollIntoView","behavior","appendChild","createTextNode","find","category","category_id","color","textContent","click","withRouter","metaSlice","favicon","menuItems","map_metadata","logoSelector","logoAltTextSelector","menuItemsSelector","fetchMetaData","dispatch","a","fetch","then","res","json","project","type","app","NavItem","href","link","getWidth","window","innerWidth","documentElement","clientWidth","body","logoUrl","altText","collapsed","useState","width","setWidth","timeoutId","resizeListener","clearTimeout","setTimeout","addEventListener","removeEventListener","useCurrentWidth","collapsedWidth","navItems","item","key","src","alt","aria-haspopup","aria-label","reverse","Spinner","spinning","WelcomeSidebar","html","setData","text","snarkdown","getWelcomePage","dangerouslySetInnerHTML","__html","RISK_MAPPING","0","1","2","3","4","5","METRIC_MAPPING","Tab","metricsSections","Object","entries","factors","value","MetricSection","metrics","current_analysis","future_analysis","Documents","Metric","level","section","tab","setTab","tabs","to","BackArrow","population","toLocaleString","minimumFractionDigits","currentPath","fetchLocationData","Promise","all","role","render","createBrowserHistory","configureStore","reducer","locationReducer","metaDataReducer","connectRouter","middleware","getDefaultMiddleware","routerMiddleware","Boolean","hostname","match","ReactDOM","StrictMode","store","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.cd8bcd96.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/left-arrow.2f02a21a.svg\";","module.exports = __webpack_public_path__ + \"static/media/community.ecd7ea28.svg\";","export function urlify_location(name) {\n  return name.toLowerCase().replace(new RegExp(\" \", \"g\"), \"-\");\n}\n\n// Blatantly stolen from npm \"canvas\" library\nfunction loadImage(src, options) {\n  return new Promise(function (resolve, reject) {\n    const image = Object.assign(document.createElement(\"img\"), options);\n\n    function cleanup() {\n      image.onload = null;\n      image.onerror = null;\n    }\n\n    image.onload = function () {\n      cleanup();\n      resolve(image);\n    };\n    image.onerror = function () {\n      cleanup();\n      reject(new Error('Failed to load the image \"' + src + '\"'));\n    };\n\n    image.src = src;\n  });\n}\n\nexport async function generatePinIcon(color) {\n  if (color[0] === \"#\") {\n    color = color.slice(1);\n  }\n\n  let data_url = `data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='34.209' width='24'%3E%3Cpath fill='none' d='M10.35 19.01h24v24h-24z'/%3E%3Cpath stroke-width='.421' stroke='%23000' fill='%23${color}' d='M12 .21A11.78 11.78 0 0 0 .21 12C.21 20.842 12 33.895 12 33.895S23.79 20.842 23.79 12A11.78 11.78 0 0 0 12 .21zm0 16A4.212 4.212 0 0 1 7.79 12 4.212 4.212 0 0 1 12 7.79 4.212 4.212 0 0 1 16.21 12 4.212 4.212 0 0 1 12 16.21z'/%3E%3C/svg%3E`;\n  return await loadImage(data_url);\n}\n\n// Stolen from https://jonlabelle.com/snippets/view/javascript/lighten-and-darken-colors-in-javascript\nexport function lightenColor(colorCode, amount) {\n  var usePound = false;\n\n  if (colorCode[0] === \"#\") {\n    colorCode = colorCode.slice(1);\n    usePound = true;\n  }\n\n  var num = parseInt(colorCode, 16);\n\n  var r = (num >> 16) + amount;\n\n  if (r > 255) {\n    r = 255;\n  } else if (r < 0) {\n    r = 0;\n  }\n\n  var b = ((num >> 8) & 0x00ff) + amount;\n\n  if (b > 255) {\n    b = 255;\n  } else if (b < 0) {\n    b = 0;\n  }\n\n  var g = (num & 0x0000ff) + amount;\n\n  if (g > 255) {\n    g = 255;\n  } else if (g < 0) {\n    g = 0;\n  }\n\n  return (usePound ? \"#\" : \"\") + (g | (b << 8) | (r << 16)).toString(16);\n}\n","import { createSlice } from \"@reduxjs/toolkit\";\nimport { createSelector } from \"reselect\";\nimport { urlify_location } from \"../../utils\";\nimport _ from \"lodash\";\nimport React, { useEffect } from \"react\";\nimport { useLocation } from \"react-router-dom\";\nimport { connect } from \"react-redux\";\nimport { push } from \"connected-react-router\";\n\nfunction getMeta(metaName) {\n  const metas = document.getElementsByTagName(\"meta\");\n\n  for (let i = 0; i < metas.length; i++) {\n    if (metas[i].getAttribute(\"name\") === metaName) {\n      return metas[i];\n    }\n  }\n\n  return \"\";\n}\n\nexport const locationSlice = createSlice({\n  name: \"location\",\n  initialState: {\n    locations: [],\n    categories: [],\n    loading: true,\n    error: null,\n    filters: {\n      max_distance: 0,\n      contains_text: \"\",\n      categories: [],\n    },\n    current_user_location: null,\n    modalIsOpen: false,\n    brandLogo: null,\n    brandAltText: null,\n    activeLocation: null,\n    features: {\n      site_name_in_location: true,\n      show_distance: false,\n    },\n  },\n  reducers: {\n    fetchDataBegin: (state) => {\n      state.loading = true;\n      state.error = null;\n    },\n    fetchDataSuccess: (state, action) => {\n      let features = action.payload.metadata.features || {};\n\n      state.locations = action.payload.locations;\n      state.categories = action.payload.categories;\n\n      state.brandLogo = action.payload.metadata.brand_logo;\n      state.brandAltText = action.payload.metadata.brand_alt;\n      state.loading = false;\n      // features\n      state.features.site_name_in_location =\n        features.site_name_in_location || state.features.site_name_in_location;\n      state.features.show_distance =\n        features.show_distance || state.features.show_distance;\n\n      document.title = action.payload.metadata.brand_alt;\n\n      getMeta(\"description\").content = action.payload.metadata.description;\n    },\n    fetchDataFailure: (state, action) => {\n      state.error = action.payload.error;\n    },\n    setMaxDistanceFilter: (state, action) => {\n      state.filters.max_distance = action.payload;\n    },\n    setTextFilter: (state, action) => {\n      state.filters.contains_text = action.payload;\n    },\n    setCategoryFilter: (state, action) => {\n      state.filters.categories = action.payload;\n    },\n    setActiveLocation: (state, action) => {\n      if (!!action.payload) {\n        document.title = action.payload.title;\n      } else {\n        document.title = \"WaterSecure\";\n      }\n      state.activeLocation = action.payload;\n    },\n  },\n});\n\nexport const {\n  fetchDataBegin,\n  fetchDataSuccess,\n  fetchDataFailure,\n  setMaxDistanceFilter,\n  setTextFilter,\n  setCategoryFilter,\n  setActiveLocation,\n  closeModal,\n} = locationSlice.actions;\n\nfunction text_in(location, text) {\n  return (\n    location.title.toLowerCase().includes(text.toLowerCase()) ||\n    location.description.toLowerCase().includes(text.toLowerCase())\n  );\n}\n\n// The function below is called a selector and allows us to select a value from\n// the state. Selectors can also be defined inline where they're used instead of\n// in the slice file. For example: `useSelector((state) => state.counter.value)`\nexport const logoSelector = (state) => state.location.brandLogo;\nexport const logoAltTextSelector = (state) => state.location.brandAltText;\nexport const filterOpenSelector = (state) => state.location.filterIsOpen;\nexport const allFilterSelector = (state) => state.location.filters;\nexport const allLocationsSelector = (state) => state.location.locations;\nexport const allCategoriesSelector = (state) => state.location.categories;\nexport const locationModalIsOpenSelector = (state) =>\n  state.location.modalIsOpen;\nexport const activeLocationSelector = (state) => state.location.activeLocation;\n\nexport const urlToLocationMapSelector = createSelector(\n  allLocationsSelector,\n  (locations) => {\n    let url_map = {};\n    for (let location of locations) {\n      console.log(location);\n      // let new_location = Object.create(location);\n      url_map[urlify_location(location.title)] = location;\n    }\n    return url_map;\n  }\n);\n\nexport function fetchLocationData() {\n  return async (dispatch) => {\n    dispatch(fetchDataBegin());\n    try {\n      const [locations, metadata, categories] = await Promise.all([\n        fetch(`./data/locations.json`).then((res) => res.json()),\n        fetch(`./data/project.json`).then((res) => res.json()),\n        fetch(`./data/categories.json`).then((res) => res.json()),\n      ]);\n      console.log(locations);\n      dispatch(\n        fetchDataSuccess({\n          locations: locations.locations,\n          metadata: metadata.metadata,\n          categories: categories.categories,\n        })\n      );\n    } catch (error) {\n      dispatch(fetchDataFailure(error));\n    }\n  };\n}\n\nlet LocationOpener = (props) => {\n  useEffect(() => {\n    // Update the document title using the browser API\n    if (props.isRoot) {\n      props.setActiveLocation(null);\n      // Update the document title using the browser API\n    } else if (!props.location) {\n      props.setActiveLocation(props.urlLocation);\n      // Update the document title using the browser API\n    }\n  });\n  return <></>;\n};\n\nLocationOpener = connect(\n  (state) => {\n    const path = state.router.location.pathname.slice(1);\n    let urlLocation = urlToLocationMapSelector(state)[path];\n    return {\n      location: activeLocationSelector(state),\n      urlLocation: urlLocation,\n      isRoot: path === \"\",\n      siteName: state.location.brandAltText,\n      site_name_in_location: state.location.features.site_name_in_location,\n    };\n  },\n  {\n    setActiveLocation,\n  }\n)(LocationOpener);\n\nexport { LocationOpener };\n\nexport default locationSlice.reducer;\n","import React from \"react\";\nimport mapboxgl from \"mapbox-gl\";\nimport { connect } from \"react-redux\";\nimport {\n  allCategoriesSelector,\n  allLocationsSelector,\n  setActiveLocation,\n} from \"../locations/locationSlice\";\nimport * as utils from \"../../utils\";\nimport memoizeOne from \"memoize-one\";\nimport \"./Map.css\";\nimport { withRouter } from \"react-router-dom\";\nimport CommunitySVG from \"./community.svg\";\nimport { community_icon, water_source_icon } from \"./icons\";\nimport { urlify_location } from \"../../utils\";\nmapboxgl.accessToken =\n  \"pk.eyJ1IjoieHJlbmRhbiIsImEiOiJjamlubXdoeDgwZDF5M3BvNzl1Nm51ZTF2In0.cRp5pTHYfVlg5Qfhh9npmg\";\n\nfunction centerMap(map, center) {\n  map.jumpTo({ center: center });\n}\nfunction zoomMap(map, zoom) {\n  map.jumpTo({ zoom: zoom });\n}\nfunction pitchMap(map, pitch) {\n  map.jumpTo({ pitch: pitch });\n}\n\nfunction loadLocations(map, locations) {\n  map.getSource(\"locations\").setData(locations);\n}\n\nfunction loadCategories(map, categories) {\n  for (let category of categories) {\n    utils.generatePinIcon(category.color).then((image) => {\n      try {\n        map.addImage(`${category.id}-icon`, image);\n      } catch (e) {}\n    });\n  }\n}\n\n//memoize map centering to ensure it only changes on center props update\nconst memoizedCenterMap = memoizeOne(\n  centerMap,\n  (newArgs, lastArgs) => newArgs.center === lastArgs.center\n);\n\nconst memoizedZoomMap = memoizeOne(\n  zoomMap,\n  (newArgs, lastArgs) => newArgs.zoom === lastArgs.zoom\n);\n\nconst memoizedPitchMap = memoizeOne(\n  pitchMap,\n  (newArgs, lastArgs) => newArgs.pitch === lastArgs.pitch\n);\n\nlet Map = class Map extends React.Component {\n  mapRef = React.createRef();\n  map;\n  state = {\n    markers: [],\n  };\n\n  nextPath(path) {\n    this.props.history.push(path);\n  }\n  memoizedLoadLocations = memoizeOne(\n    this.loadLocations,\n    (newArgs, lastArgs) => newArgs.locations === lastArgs.locations\n  );\n  loadLocations(locations) {\n    this.state.markers.forEach((marker) => {\n      marker.remove();\n    });\n    let markers = [];\n    locations.forEach((location) => {\n      console.log(location);\n      let el = document.createElement(\"div\");\n      el.className = \"community\";\n      el.id = `community-${location.id}`;\n      el.innerHTML = community_icon;\n      el.onclick = (e) => {\n        console.log(e);\n        this.props.setActiveLocation(location);\n        this.nextPath(`/${urlify_location(location.title)}`);\n      };\n      let popup = new mapboxgl.Popup({\n        closeButton: false,\n        closeOnClick: false,\n        anchor: \"bottom\",\n        offset: 40,\n      });\n      el.onmouseenter = (e) => {\n        popup\n          .setLngLat(location.coordinates)\n          .setHTML(location.title)\n          .addTo(this.map);\n      };\n\n      el.onmouseleave = (e) => {\n        popup.remove();\n      };\n\n      const marker = new mapboxgl.Marker(el)\n        .setLngLat(location.coordinates)\n        .addTo(this.map);\n      markers.push(marker);\n\n      location.water_sources.forEach((water_source) => {\n        let el = document.createElement(\"div\");\n        el.className = `water-source water-source-${location.id}`;\n        el.innerHTML = water_source_icon;\n        el.onmouseenter = (e) => {\n          popup\n            .setLngLat(water_source.coordinates)\n            .setHTML(water_source.name)\n            .addTo(this.map);\n        };\n\n        el.onmouseleave = (e) => {\n          popup.remove();\n        };\n        const marker = new mapboxgl.Marker(el)\n          .setLngLat(water_source.coordinates)\n          .addTo(this.map);\n        markers.push(marker);\n      });\n      this.setState({\n        markers: markers,\n      });\n    });\n  }\n\n  componentDidUpdate() {\n    this.memoizedLoadLocations(this.props.locations);\n    try {\n      memoizedCenterMap(this.map, this.props.center);\n    } catch (e) {\n      console.log(e);\n      throw e;\n    }\n    try {\n      memoizedZoomMap(this.map, this.props.zoom);\n    } catch (e) {}\n    try {\n      memoizedPitchMap(this.map, this.props.pitch);\n    } catch (e) {}\n  }\n  componentDidMount() {\n    this.map = new mapboxgl.Map({\n      container: this.mapRef.current,\n      style: \"mapbox://styles/mapbox/streets-v9\",\n      customAttribution: \"Icons by fjstudio & Freepik on Flaticon\",\n      center: this.props.center,\n      zoom: this.props.zoom,\n      pitch: this.props.pitch,\n    });\n\n    this.map.on(\"load\", () => {\n      this.loadLocations(this.props.locations);\n    });\n    let popup = new mapboxgl.Popup({\n      closeButton: false,\n      closeOnClick: false,\n      anchor: \"bottom\",\n      offset: 40,\n    });\n    this.map.on(\"mouseenter\", \"locations\", (e) => {\n      // TODO: action on hover\n      this.props.onHover(e);\n\n      this.map.getCanvas().style.cursor = \"pointer\";\n\n      var coordinates = e.features[0].geometry.coordinates.slice();\n      var description = e.features[0].properties.title;\n\n      // Ensure that if the map is zoomed out such that multiple\n      // copies of the feature are visible, the popup appears\n      // over the copy being pointed to.\n      while (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {\n        coordinates[0] += e.lngLat.lng > coordinates[0] ? 360 : -360;\n      }\n\n      // Populate the popup and set its coordinates\n      // based on the feature found.\n      popup.setLngLat(coordinates).setHTML(description).addTo(this.map);\n    });\n\n    this.map.on(\"click\", \"locations\", (e) => {\n      this.props.onClick(e);\n    });\n\n    this.map.on(\"mouseleave\", \"locations\", (e) => {\n      this.map.getCanvas().style.cursor = \"\";\n      popup.remove();\n      this.props.onMouseLeave(e);\n    });\n  }\n\n  render() {\n    return (\n      <div\n        ref={this.mapRef}\n        style={{\n          height: \"100%\",\n        }}\n      />\n    );\n  }\n};\n\nfunction getBackgroundCSS(elementID, pinColour) {\n  let backgroundColor = utils.lightenColor(pinColour, 175);\n  return `#${elementID} { background-color: ${backgroundColor};}`;\n}\n\nfunction mapStateToProps(state) {\n  let categories = allCategoriesSelector(state);\n  return {\n    center: state.metadata.initial_map_center,\n    zoom: state.metadata.initial_map_zoom,\n    pitch: state.metadata.initial_map_pitch,\n    categories: allCategoriesSelector(state),\n    locations: allLocationsSelector(state),\n    // TODO: pull out of Map\n    onHover: (e) => {\n      let locationHtmlId = `location-${e.features[0].properties.id}`;\n      let elmnt = document.getElementById(locationHtmlId);\n      if (elmnt !== null) {\n        elmnt.scrollIntoView({ behavior: \"smooth\" });\n      }\n      let style = document.getElementById(\"hover-style\");\n      style.appendChild(\n        document.createTextNode(\n          getBackgroundCSS(\n            locationHtmlId,\n            categories.find(\n              (category) => category.id === e.features[0].properties.category_id\n            ).color\n          )\n        )\n      );\n    },\n    onMouseLeave: () => {\n      let style = document.getElementById(\"hover-style\");\n      style.textContent = \"\";\n    },\n    onClick: (e) => {\n      // TODO: Make this not so hacky\n      let elmnt = document.getElementById(\n        `location-${e.features[0].properties.id}`\n      );\n      if (elmnt !== null) {\n        elmnt.click();\n      }\n    },\n  };\n}\n\nMap = connect(mapStateToProps, { setActiveLocation })(Map);\n\nexport default withRouter(Map);\n","export const water_source_icon =\n  '<svg id=\"Capa_1\" enable-background=\"new 0 0 512 512\" height=\"512\" viewBox=\"0 0 512 512\" width=\"512\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"m332.667 225.548c-14.338 0-27.961-5.373-38.334-14.536-10.372 9.164-23.994 14.536-38.333 14.536-14.338 0-27.961-5.373-38.333-14.536-10.373 9.163-23.995 14.536-38.333 14.536-7.198 0-14.16-1.311-20.616-3.751 10.483 44 50.119 76.822 97.283 76.822s86.8-32.822 97.283-76.822c-6.457 2.44-13.419 3.751-20.617 3.751z\"/><path d=\"m179.334 195.548c10.588 0 20.329-6.029 24.814-15.358 2.498-5.196 7.753-8.5 13.519-8.5s11.021 3.304 13.519 8.5c4.486 9.33 14.226 15.358 24.815 15.358s20.329-6.028 24.814-15.358c2.498-5.196 7.753-8.5 13.519-8.5 5.765 0 11.021 3.304 13.519 8.5 4.486 9.33 14.227 15.359 24.815 15.359 9.004 0 17.222-4.208 22.311-11.194-6.944-48.407-48.68-85.735-98.978-85.735s-92.034 37.329-98.978 85.736c5.089 6.985 13.307 11.192 22.311 11.192z\"/><path d=\"m437.547 114.538c-15.946-33.427-40.411-61.704-70.748-81.776-32.393-21.433-70.708-32.762-110.799-32.762s-78.406 11.329-110.8 32.762c-30.336 20.071-54.8 48.349-70.747 81.776s-22.533 70.234-19.046 106.442c3.724 38.664 19.025 75.571 44.251 106.732l144.684 178.727c2.848 3.517 7.132 5.561 11.658 5.561s8.811-2.044 11.659-5.562l144.684-178.727c25.225-31.161 40.526-68.068 44.25-106.732 3.487-36.208-3.099-73.015-19.046-106.441zm-181.547 214.081c-71.682 0-130-58.318-130-130 0-4.237.211-8.425.609-12.558.004-.038.006-.076.01-.114 6.392-65.758 61.975-117.328 129.381-117.328 67.381 0 122.947 51.53 129.374 117.25.019.15.026.3.04.451.382 4.05.586 8.151.586 12.299 0 71.682-58.317 130-130 130z\"/></svg>';\nexport const community_icon =\n  '<svg height=\"512\" viewBox=\"0 0 192 192\" width=\"512\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"m96 0a72.081 72.081 0 0 0 -72 72c0 50.73 63.634 114.948 66.343 117.657a8.078 8.078 0 0 0 11.314 0c2.709-2.709 66.343-66.927 66.343-117.657a72.081 72.081 0 0 0 -72-72zm0 120a48 48 0 1 1 48-48 48 48 0 0 1 -48 48z\"/><path d=\"m129.789 60.422-32-16a4 4 0 0 0 -3.578 0l-32 16 3.578 7.156 10.211-5.106v25.528a4 4 0 0 0 4 4h32a4 4 0 0 0 4-4v-25.528l10.211 5.106z\"/></svg>';\n","import { createSlice } from \"@reduxjs/toolkit\";\n\nfunction getMeta(metaName) {\n  const metas = document.getElementsByTagName(\"meta\");\n\n  for (let i = 0; i < metas.length; i++) {\n    if (metas[i].getAttribute(\"name\") === metaName) {\n      return metas[i];\n    }\n  }\n\n  return \"\";\n}\nexport const metaSlice = createSlice({\n  name: \"metadata\",\n  initialState: {\n    loading: true,\n    error: null,\n    brandLogo: null,\n    brandAltText: null,\n    title: null,\n    favicon: null,\n    menuItems: [],\n    description: null,\n    initial_map_center: [-113.496548, 53.511435],\n    initial_map_zoom: [11.25],\n    initial_map_pitch: [50],\n  },\n  reducers: {\n    fetchDataBegin: (state) => {\n      state.loading = true;\n      state.error = null;\n    },\n    fetchDataSuccess: (state, action) => {\n      state.loading = false;\n      state.error = null;\n      state.brandLogo = action.payload.metadata.brand_logo;\n      state.brandAltText = action.payload.metadata.brand_alt;\n      state.title = action.payload.metadata.title;\n      state.favicon = action.payload.metadata.favicon;\n      state.menuItems = action.payload.metadata.menuItems;\n      state.description = action.payload.metadata.description;\n      document.title = action.payload.metadata.title;\n\n      state.initial_map_center =\n        action.payload.map_metadata.initial_map_center.coordinates;\n      state.initial_map_zoom = [action.payload.map_metadata.initial_map_zoom];\n      state.initial_map_pitch = [action.payload.map_metadata.initial_map_pitch];\n\n      getMeta(\"description\").content = action.payload.metadata.description;\n    },\n    fetchDataFailure: (state, action) => {\n      state.error = action.payload.error;\n    },\n  },\n});\nexport const logoSelector = (state) => state.metadata.brandLogo;\nexport const logoAltTextSelector = (state) => state.metadata.brandAltText;\nexport const menuItemsSelector = (state) => state.metadata.menuItems || [];\n\nexport const {\n  fetchDataBegin,\n  fetchDataSuccess,\n  fetchDataFailure,\n} = metaSlice.actions;\n\nexport function fetchMetaData() {\n  return async (dispatch) => {\n    dispatch(fetchDataBegin());\n    try {\n      const project = await fetch(`./data/project.json`).then((res) =>\n        res.json()\n      );\n      let map_metadata = project.metadata[\"map\"];\n      map_metadata.initial_map_center = {\n        initial_map_center: {\n          type: \"Point\",\n          coordinates: map_metadata.initial_map_center,\n        },\n      };\n      dispatch(\n        fetchDataSuccess({\n          metadata: project.metadata.app,\n          map_metadata: map_metadata,\n        })\n      );\n    } catch (error) {\n      dispatch(fetchDataFailure(error));\n    }\n  };\n}\n\nexport default metaSlice.reducer;\n","import React, { useEffect, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport {\n  fetchMetaData,\n  logoAltTextSelector,\n  logoSelector,\n  menuItemsSelector,\n} from \"./metaSlice\";\nimport \"./NavBar.css\";\n\nfunction NavItem(props) {\n  return (\n    <li className=\"nav-item\">\n      <a href={props.link}>{props.title}</a>\n    </li>\n  );\n}\n\nconst getWidth = () =>\n  window.innerWidth ||\n  document.documentElement.clientWidth ||\n  document.body.clientWidth;\n\nfunction useCurrentWidth() {\n  // save current window width in the state object\n  let [width, setWidth] = useState(getWidth());\n\n  // in this case useEffect will execute only once because\n  // it does not have any dependencies.\n  useEffect(() => {\n    // timeoutId for debounce mechanism\n    let timeoutId = null;\n    const resizeListener = () => {\n      // prevent execution of previous setTimeout\n      clearTimeout(timeoutId);\n      // change width from the state object after 150 milliseconds\n      timeoutId = setTimeout(() => setWidth(getWidth()), 150);\n    };\n    // set resize listener\n    window.addEventListener(\"resize\", resizeListener);\n\n    // clean up function\n    return () => {\n      // remove resize listener\n      window.removeEventListener(\"resize\", resizeListener);\n    };\n  }, []);\n\n  return width;\n}\n\nfunction NavBar(props) {\n  let width = useCurrentWidth();\n  let collapsedWidth = props.collapsedWidth || 992;\n  let collapsed = width < collapsedWidth;\n\n  let { menuItems } = props;\n\n  const navItems = menuItems.map((item) => {\n    return <NavItem key={item.title} {...item} />;\n  });\n\n  return (\n    <>\n      <div className=\"vertical-center nav-title\">\n        <img src={props.logoUrl} alt={props.altText} />\n      </div>\n      <ul className=\"nav-items\">\n        {collapsed ? (\n          <li className=\"vertical-center\">\n            <a href=\"#\" aria-haspopup=\"true\">\n              Menu\n            </a>\n            <ul className=\"dropdown\" aria-label=\"sublabel\">\n              {navItems}\n            </ul>\n          </li>\n        ) : (\n          navItems.slice(0).reverse()\n        )}\n      </ul>\n    </>\n  );\n}\n\nfunction mapStateToProps(state) {\n  return {\n    logoUrl: logoSelector(state),\n    altText: logoAltTextSelector(state),\n    menuItems: menuItemsSelector(state),\n  };\n}\n\nexport default connect(mapStateToProps, { fetchMetaData })(NavBar);\n","import React from \"react\";\nimport { connect } from \"react-redux\";\nimport \"./Spinner.css\";\n\nclass Spinner extends React.Component {\n  render() {\n    return this.props.spinning ? (\n      <div className={\"overlay\"}>\n        <div className={\"spinner\"} />\n      </div>\n    ) : null;\n  }\n}\n\nfunction mapStateToProps(state) {\n  return { spinning: state.location.loading };\n}\n\nexport default connect(mapStateToProps)(Spinner);\n","import snarkdown from \"snarkdown\";\nimport React, { useState, useEffect } from \"react\";\nimport \"./Welcome.css\";\n\nfunction WelcomeSidebar() {\n  const [html, setData] = useState(\"\");\n\n  useEffect(() => {\n    async function getWelcomePage() {\n      const res = await fetch(`./data/welcome.md`).then((res) => res.text());\n\n      setData(snarkdown(res));\n    }\n    getWelcomePage();\n  }, []);\n\n  return (\n    <div\n      className=\"sidebar welcome\"\n      dangerouslySetInnerHTML={{ __html: html }}\n    />\n  );\n}\n\nexport default WelcomeSidebar;\n","import React, { useState } from \"react\";\nimport \"./LocationSidebar.css\";\nimport { Link } from \"react-router-dom\";\nimport BackArrow from \"./left-arrow.svg\";\nimport { connect } from \"react-redux\";\nimport { activeLocationSelector } from \"./locationSlice\";\n\nconst RISK_MAPPING = {\n  0: \"UNAVAILABLE INFORMATION\",\n  1: \"VERY LOW RISK\",\n  2: \"LOW RISK\",\n  3: \"MODERATE RISK\",\n  4: \"HIGH RISK\",\n  5: \"VERY HIGH RISK\",\n};\nconst METRIC_MAPPING = {\n  \"Sources and Availability\": {\n    0: \"UNAVAILABLE INFORMATION\",\n    1: \"VERY HIGH ACCESS\",\n    2: \"HIGH ACCESS\",\n    3: \"MODERATE ACCESS\",\n    4: \"LOW ACCESS\",\n    5: \"VERY LOW ACCESS\",\n  },\n  \"Consumption and Usage\": {\n    0: \"UNAVAILABLE INFORMATION\",\n    1: \"VERY LOW CONSUMPTION\",\n    2: \"LOW CONSUMPTION\",\n    3: \"MODERATE CONSUMPTION\",\n    4: \"HIGH CONSUMPTION\",\n    5: \"VERY HIGH CONSUMPTION\",\n  },\n  \"Infrastructure and Distribution\": {\n    0: \"UNAVAILABLE INFORMATION\",\n    1: \"VERY STRONG INFRASTRUCTURE\",\n    2: \"STRONG INFRASTRUCTURE\",\n    3: \"ADEQUATE INFRASTRUCTURE\",\n    4: \"POOR INFRASTRUCTURE\",\n    5: \"VERY POOR INFRASTRUCTURE\",\n  },\n  \"Human Health\": RISK_MAPPING,\n  \"Animal Health\": RISK_MAPPING,\n  \"Waterbody Health\": RISK_MAPPING,\n  \"Human Pollution\": RISK_MAPPING,\n};\n\nfunction Tab(props) {\n  let metricsSections = [];\n  for (const [key, value] of Object.entries(props.factors)) {\n    metricsSections.push(\n      <MetricSection key={key} title={key} metrics={value} />\n    );\n  }\n  return (\n    <div className=\"tab\">\n      <p>{props.current_analysis}</p>\n      {metricsSections}\n      <p>{props.future_analysis}</p>\n    </div>\n  );\n}\n\nfunction Documents() {\n  return <div className=\"documents\">Hello</div>;\n}\n\nfunction Metric(props) {\n  return (\n    <div className=\"metric\">\n      <div className={`indicator level-${props.level}`} />\n      <div className=\"metric-text\">\n        <div className=\"metric-title\">{props.title}</div>\n        <div className=\"metric-value\">\n          {METRIC_MAPPING[props.section][props.level]}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction MetricSection(props) {\n  let metrics = [];\n  for (const [key, value] of Object.entries(props.metrics)) {\n    metrics.push(\n      <Metric section={props.title} key={key} title={key} level={value} />\n    );\n  }\n\n  return (\n    <div className=\"metric-section\">\n      <h2>{props.title}</h2>\n      {metrics}\n    </div>\n  );\n}\n\nfunction LocationSidebar(props) {\n  const [tab, setTab] = useState(\"Water Security\");\n  console.log(tab);\n  if (!props.location) {\n    return <div className=\"sidebar location-sidebar\" />;\n  }\n  let tabs = props.location.tabs;\n\n  return (\n    <div className=\"sidebar location-sidebar\">\n      <div className=\"content\">\n        <div className=\"header\">\n          <h1>\n            <Link to=\"/\">\n              <img className=\"backarrow\" src={BackArrow} alt=\"back\" />\n            </Link>\n            {props.location.title}\n          </h1>\n          <p>\n            Population of{\" \"}\n            {props.location.population.toLocaleString(\"en-US\", {\n              minimumFractionDigits: 0,\n            })}\n          </p>\n        </div>\n        <br />\n        <p>{props.location.description}</p>\n        <button onClick={() => setTab(\"Water Security\")}>Water Security</button>\n        <button onClick={() => setTab(\"Population Health\")}>\n          Population Health\n        </button>\n        <button onClick={() => setTab(\"Environmental Risks\")}>\n          Environmental Risks\n        </button>\n\n        {tab === \"Water Security\" ? <Tab {...tabs[\"Water Security\"]} /> : null}\n\n        {tab === \"Population Health\" ? (\n          <Tab {...tabs[\"Population Health\"]} />\n        ) : null}\n\n        {tab === \"Environmental Risks\" ? (\n          <Tab {...tabs[\"Environmental Risks\"]} />\n        ) : null}\n      </div>\n      <Documents />\n    </div>\n  );\n}\nfunction mapStateToProps(state) {\n  return {\n    location: activeLocationSelector(state),\n  };\n}\n\nexport default connect(mapStateToProps)(LocationSidebar);\n","import React, { useState, useEffect } from \"react\";\n\nimport Map from \"./features/map/Map\";\nimport \"./App.css\";\nimport UserNav from \"./features/Meta/NavBar\";\nimport { Route } from \"react-router-dom\";\nimport Spinner from \"./features/locations/Spinner\";\nimport { connect } from \"react-redux\";\nimport { fetchMetaData } from \"./features/Meta/metaSlice\";\nimport WelcomeSidebar from \"./features/Meta/WelcomeSidebar\";\nimport {\n  activeLocationSelector,\n  fetchLocationData,\n  LocationOpener,\n} from \"./features/locations/locationSlice\";\nimport LocationSidebar from \"./features/locations/LocationSidebar\";\n\nfunction App(props) {\n  // Set Title properly\n  let { fetchMetaData, fetchLocationData } = props;\n\n  useEffect(() => {\n    if (props.currentPath === \"\") document.title = props.siteName;\n  });\n\n  useEffect(() => {\n    fetchMetaData();\n  }, [fetchMetaData]);\n\n  useEffect(() => {\n    fetchLocationData();\n  }, [fetchLocationData]);\n\n  return (\n    <>\n      <nav role=\"navigation\" className=\"navbar\">\n        <UserNav />\n      </nav>\n      <WelcomeSidebar />\n      <LocationSidebar />\n      <div className=\"map\">{false ? null : <Map />}</div>\n      {/*<Spinner />*/}\n      {/*<Container fluid style={{ margin: 0, padding: 0, height: \"100%\" }}>*/}\n      {/*  <Row*/}\n      {/*    no-gutters=\"true\"*/}\n      {/*    style={{ margin: 0, padding: 0, height: \"100%\" }}*/}\n      {/*  >*/}\n      {/*    <Col*/}\n      {/*      className=\"locations-sidebar\"*/}\n      {/*      lg=\"3\"*/}\n      {/*      style={{*/}\n      {/*        height: \"100%\",*/}\n      {/*        position: \"absolute\",*/}\n      {/*        margin: 0,*/}\n      {/*        padding: 0,*/}\n      {/*        left: 0,*/}\n      {/*        top: 0,*/}\n      {/*      }}*/}\n      {/*    >*/}\n      {/*      <UserNav />*/}\n      {/*      <LocationList />*/}\n      {/*    </Col>*/}\n      {/*    <Col*/}\n      {/*      className=\"locations-sidebar\"*/}\n      {/*      lg=\"3\"*/}\n      {/*      style={{ height: \"100%\" }}*/}\n      {/*    />*/}\n      {/*    <Col*/}\n      {/*      id=\"map\"*/}\n      {/*      lg=\"9\"*/}\n      {/*      style={{*/}\n      {/*        margin: 0,*/}\n      {/*        padding: 0,*/}\n      {/*        height: \"100vh\",*/}\n      {/*        position: \"relative\",*/}\n      {/*      }}*/}\n      {/*    >*/}\n      {/*      <MobileNav className={\"mobile-navbar\"} />*/}\n      {/*      {props.loading ? null : <Map />}*/}\n      {/*    </Col>*/}\n      {/*  </Row>*/}\n      {/*</Container>*/}\n      <Route\n        path=\"/:locationName\"\n        render={() => (\n          <style\n            dangerouslySetInnerHTML={{\n              __html: `div.location-sidebar { width: 100%; }`,\n            }}\n          />\n        )}\n      />\n      <LocationOpener />\n    </>\n  );\n}\n\nfunction mapStateToProps(state) {\n  return {\n    location: activeLocationSelector(state),\n    spinning: state.location.loading,\n    siteName: state.location.brandAltText,\n    currentPath: state.router.location.pathname.slice(1),\n  };\n}\n\nexport default connect(mapStateToProps, { fetchMetaData, fetchLocationData })(\n  App\n);\n","import { configureStore, getDefaultMiddleware } from \"@reduxjs/toolkit\";\nimport locationReducer from \"../features/locations/locationSlice\";\nimport metaDataReducer from \"../features/Meta/metaSlice\";\nimport { connectRouter } from \"connected-react-router\";\nimport { createBrowserHistory } from \"history\";\nimport { routerMiddleware } from \"connected-react-router\";\n\nexport let history = createBrowserHistory({\n  /* pass a configuration object here if needed */\n});\n\nexport default configureStore({\n  reducer: {\n    location: locationReducer,\n    metadata: metaDataReducer,\n    router: connectRouter(history),\n  },\n  middleware: [\n    ...getDefaultMiddleware(),\n    routerMiddleware(history), // for dispatching history actions\n  ],\n});\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === \"localhost\" ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === \"[::1]\" ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === \"production\" && \"serviceWorker\" in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener(\"load\", () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            \"This web app is being served cache-first by a service \" +\n              \"worker. To learn more, visit https://bit.ly/CRA-PWA\"\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === \"installed\") {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                \"New content is available and will be used when all \" +\n                  \"tabs for this page are closed. See https://bit.ly/CRA-PWA.\"\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log(\"Content is cached for offline use.\");\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error(\"Error during service worker registration:\", error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { \"Service-Worker\": \"script\" },\n  })\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get(\"content-type\");\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf(\"javascript\") === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        \"No internet connection found. App is running in offline mode.\"\n      );\n    });\n}\n\nexport function unregister() {\n  if (\"serviceWorker\" in navigator) {\n    navigator.serviceWorker.ready.then((registration) => {\n      registration.unregister();\n    });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport store from \"./app/store\";\nimport { history } from \"./app/store\";\nimport { Provider } from \"react-redux\";\nimport { ConnectedRouter } from \"connected-react-router\";\nimport * as serviceWorker from \"./serviceWorker\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <ConnectedRouter history={history}>\n        {\" \"}\n        {/* place ConnectedRouter under Provider */}\n        <App />\n      </ConnectedRouter>\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}